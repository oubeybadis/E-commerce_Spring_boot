<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" th:replace="~{layout/base :: layout(~{::content})}">

<body>
    <div th:fragment="content" class="px-4 md:px-44">
        <div dir="rtl" class="md:grid md:grid-cols-2 flex flex-col-reverse gap-4 md:gap-16 md:mt-40 mt-32">
            <div class="dark:text-white flex flex-col gap-3">
                <h1 class="text-3xl uppercase font-semibold" th:text="${product.name}">Product Name</h1>
                
                <!-- Rating Stars -->
                <div class="flex items-center mt-2.5 mb-2.5">
                    <div class="flex items-center space-x-1 rtl:space-x-reverse">
                        <svg class="w-4 h-4 text-yellow-300" aria-hidden="true" xmlns="http://www.w3.org/2000/svg"
                            fill="currentColor" viewBox="0 0 22 20">
                            <path
                                d="M20.924 7.625a1.523 1.523 0 0 0-1.238-1.044l-5.051-.734-2.259-4.577a1.534 1.534 0 0 0-2.752 0L7.365 5.847l-5.051.734A1.535 1.535 0 0 0 1.463 9.2l3.656 3.563-.863 5.031a1.532 1.532 0 0 0 2.226 1.616L11 17.033l4.518 2.375a1.534 1.534 0 0 0 2.226-1.617l-.863-5.03L20.537 9.2a1.523 1.523 0 0 0 .387-1.575Z" />
                        </svg>
                        <svg class="w-4 h-4 text-yellow-300" aria-hidden="true" xmlns="http://www.w3.org/2000/svg"
                            fill="currentColor" viewBox="0 0 22 20">
                            <path
                                d="M20.924 7.625a1.523 1.523 0 0 0-1.238-1.044l-5.051-.734-2.259-4.577a1.534 1.534 0 0 0-2.752 0L7.365 5.847l-5.051.734A1.535 1.535 0 0 0 1.463 9.2l3.656 3.563-.863 5.031a1.532 1.532 0 0 0 2.226 1.616L11 17.033l4.518 2.375a1.534 1.534 0 0 0 2.226-1.617l-.863-5.03L20.537 9.2a1.523 1.523 0 0 0 .387-1.575Z" />
                        </svg>
                        <svg class="w-4 h-4 text-yellow-300" aria-hidden="true" xmlns="http://www.w3.org/2000/svg"
                            fill="currentColor" viewBox="0 0 22 20">
                            <path
                                d="M20.924 7.625a1.523 1.523 0 0 0-1.238-1.044l-5.051-.734-2.259-4.577a1.534 1.534 0 0 0-2.752 0L7.365 5.847l-5.051.734A1.535 1.535 0 0 0 1.463 9.2l3.656 3.563-.863 5.031a1.532 1.532 0 0 0 2.226 1.616L11 17.033l4.518 2.375a1.534 1.534 0 0 0 2.226-1.617l-.863-5.03L20.537 9.2a1.523 1.523 0 0 0 .387-1.575Z" />
                        </svg>
                        <svg class="w-4 h-4 text-yellow-300" aria-hidden="true" xmlns="http://www.w3.org/2000/svg"
                            fill="currentColor" viewBox="0 0 22 20">
                            <path
                                d="M20.924 7.625a1.523 1.523 0 0 0-1.238-1.044l-5.051-.734-2.259-4.577a1.534 1.534 0 0 0-2.752 0L7.365 5.847l-5.051.734A1.535 1.535 0 0 0 1.463 9.2l3.656 3.563-.863 5.031a1.532 1.532 0 0 0 2.226 1.616L11 17.033l4.518 2.375a1.534 1.534 0 0 0 2.226-1.617l-.863-5.03L20.537 9.2a1.523 1.523 0 0 0 .387-1.575Z" />
                        </svg>
                        <svg class="w-4 h-4 text-gray-200 dark:text-gray-600" aria-hidden="true"
                            xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 22 20">
                            <path
                                d="M20.924 7.625a1.523 1.523 0 0 0-1.238-1.044l-5.051-.734-2.259-4.577a1.534 1.534 0 0 0-2.752 0L7.365 5.847l-5.051.734A1.535 1.535 0 0 0 1.463 9.2l3.656 3.563-.863 5.031a1.532 1.532 0 0 0 2.226 1.616L11 17.033l4.518 2.375a1.534 1.534 0 0 0 2.226-1.617l-.863-5.03L20.537 9.2a1.523 1.523 0 0 0 .387-1.575Z" />
                        </svg>
                    </div>
                    <span
                        class="bg-blue-100 text-blue-800 text-xs font-semibold px-2.5 py-0.5 rounded dark:bg-blue-200 dark:text-blue-800 ms-3">5.0</span>
                </div>
                
                <!-- Description -->
                <p th:if="${product.description != null and !product.description.isEmpty()}" 
                   th:text="${product.description}">
                    Product description
                </p>
                
                <!-- Price -->
                <span class="text-3xl font-bold" th:text="|${product.price} DA|">Price</span>
                
                <!-- Buy Button -->
                <a href="#order" 
                   th:style="'background-color: ' + ${themeSetting != null ? themeSetting.primaryColor : '#03aec9'} + ';'"
                   class="flex gap-2 w-1/2 justify-center items-center text-white focus:ring-4 focus:outline-none focus:ring-blue-300 font-medium rounded-lg text-sm px-5 py-2.5 text-center dark:hover:bg-[#0195ab] dark:focus:ring-blue-800">
                    اشتري الآن
                    <svg class="w-6 h-6 text-white dark:text-white" aria-hidden="true" xmlns="http://www.w3.org/2000/svg"
                        width="24" height="24" fill="none" viewBox="0 0 24 24">
                        <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                            d="M4 4h1.5L8 16m0 0h8m-8 0a2 2 0 1 0 0 4 2 2 0 0 0 0-4Zm8 0a2 2 0 1 0 0 4 2 2 0 0 0 0-4Zm.75-3H7.5M11 7H6.312M17 4v6m-3-3h6" />
                    </svg>
                </a>
                
                <hr th:style="'border: 1px solid ' + ${themeSetting != null ? themeSetting.primaryColor : '#03aec9'} + ';'" 
                    class="my-6 dark:border-[#00c8e9]" />
                
                <!-- Sizes and Colors -->
                <div id="order" class="grid grid-cols-2 gap-8">
                    <!-- Sizes -->
                    <div th:if="${product.sizes != null and !product.sizes.isEmpty()}">
                        <h1 class="mb-2 text-gray-400 font-semibold">الأحجام</h1>
                        <div class="flex gap-1">
                            <span th:each="size : ${product.sizes}"
                                class="bg-blue-100 block text-blue-800 text-xs font-semibold px-2.5 py-0.5 rounded dark:bg-blue-200 dark:text-blue-800 uppercase"
                                th:text="${size.name}">Size</span>
                        </div>
                    </div>
                    
                    <!-- Colors -->
                    <div th:if="${product.colors != null and !product.colors.isEmpty()}">
                        <h1 class="mb-2 text-gray-400 font-semibold">الألوان</h1>
                        <div class="flex gap-1">
                            <span th:each="color : ${product.colors}"
                                class="flex w-4 h-4 rounded-full border border-black"
                                th:style="'background-color: ' + ${color.hexCode} + ';'"></span>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Product Images -->
            <div class="">
                <div class="grid gap-4">
                    <!-- Main Image -->
                    <div>
                        <img id="mainImage" 
                             class="h-60 w-auto rounded-lg transition duration-500"
                             th:src="${product.mainImage != null ? '/storage/' + product.mainImage.imageUrl : (product.images != null && !product.images.isEmpty() ? '/storage/' + product.images[0].imageUrl : '/imgs/placeholder.png')}" 
                             alt="Product image" 
                             onerror="this.src='/imgs/placeholder.png'" />
                    </div>
                    
                    <!-- Thumbnail Images -->
                    <div class="grid grid-cols-5 gap-4" th:if="${product.images != null and !product.images.isEmpty()}">
                        <div class="self-center" th:each="image, iterStat : ${product.images}" 
                             th:if="${image != null and (image.isMain == null or !image.isMain)}">
                            <img class="thumbnail hover:shadow-md dark:shadow-slate-500 h-auto max-w-full rounded-lg cursor-pointer"
                                 th:classappend="${iterStat.first} ? 'border-4 border-blue-500' : ''"
                                 th:src="'/storage/' + ${image.imageUrl}" 
                                 alt="Product thumbnail"
                                 onerror="this.src='/imgs/placeholder.png'" />
                        </div>
                    </div>
                </div>
                
                <!-- Image Gallery Script -->
                <script>
                    document.addEventListener('DOMContentLoaded', function() {
                        const thumbnails = document.querySelectorAll('.thumbnail');
                        const mainImage = document.getElementById('mainImage');
                
                        // Initially add border to the first thumbnail
                        if (thumbnails.length > 0) {
                            thumbnails[0].classList.add('border-4', 'border-blue-500');
                        }
                
                        thumbnails.forEach(thumbnail => {
                            thumbnail.addEventListener('click', function() {
                                // Remove border from all thumbnails
                                thumbnails.forEach(img => img.classList.remove('border-4', 'border-blue-500'));
                
                                // Add border to the clicked thumbnail
                                this.classList.add('border-4', 'border-blue-500');
                
                                // Apply smooth transition to the main image
                                mainImage.style.opacity = 0;
                                setTimeout(() => {
                                    mainImage.src = this.src;
                                    mainImage.style.opacity = 1;
                                }, 250);
                            });
                        });
                    });
                </script>
            </div>
        </div>
    </div>
</body>
</html>

